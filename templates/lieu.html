{% extends "base.html" %}
{% load i18n %}
{% load extras %}
{% load url from future %}

{% block title %}
  {{ lieu }}
{% endblock %}

{% block body %}
  <h3>
    {{ lieu.nom }}{% if lieu.parent %}, <a href="{% url 'catalogue.views.detail_lieu' lieu.parent.slug %}">{{ lieu.parent.nom }}</a>{% endif %}
  </h3>
  Nature : {{ lieu.nature|capfirst }}<br />
  {% for enfant in lieu.enfants.all %}
    {% if forloop.first %}Lieux contenus dans {{ lieu.nom }} :<ul>{% endif %}
    <li><a href="{% url 'catalogue.views.index_lieux' %}{{ enfant.slug }}">{{ enfant.nom }}</a></li>
    {% if forloop.last %}</ul>{% endif %}
  {% endfor %}
  {% for evenement in lieu.evenements %}
    {% if forloop.first %}
      <a href="{% url 'catalogue.views.index_evenements' %}{{ lieu.slug }}">Événements :</a>
      <ul>
    {% endif %}
    <li>
      <a href="{% url 'catalogue.views.index_evenements' %}{{ lieu.slug }}/{{ evenement.ancrage_debut.year }}/{{ evenement.ancrage_debut.month }}/{{ evenement.ancrage_debut.day }}">
        {{ evenement.ancrage_debut.calc_moment|capfirst }} :
        <ol>
          {% for element in evenement.programme.all %}
            <li>{{ element.html }}</li>
          {% endfor %}
        </ol>
      </a>
    </li>
    {% if forloop.last %}
      </ul>
    {% endif %}
  {% empty %}
    {% if not lieu.enfants.all %}
      Aucun événement référencé pour ce lieu.<br />
    {% endif %}
  {% endfor %}
  <br />
  {% if lieu.historique %}
    <h4>Historique :</h4>
    {{ lieu.historique }}
  {% endif %}
  <a href="{% url 'admin:catalogue_lieu_change' lieu.pk %}">
    [Modifier]
  </a>
{% endblock %}

