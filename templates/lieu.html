{% extends "base.html" %}
{% load i18n %}
{% load extras %}
{% load url from future %}

{% block title %}
  {{ lieu }}
{% endblock %}

{% block body %}
  <h2>
    {{ lieu.nom }}{% if lieu.parent %}, <a href="{% url 'catalogue.views.detail_lieu' lieu.parent.slug %}">{{ lieu.parent.nom }}</a>{% endif %}
  </h2>
  <h3 title="nature">
    {{ lieu.nature|capfirst }}
  </h3>
  <br />
  <dl>
    {% for enfant in lieu.enfants.all %}
      {% if forloop.first %}
        <dt>Lieu{{ lieu.enfants.all|pluralize:"x" }} contenus dans {{ lieu.nom }}</dt>
      {% endif %}
      <dd><a href="{% url 'catalogue.views.index_lieux' %}{{ enfant.slug }}">{{ enfant.nom }}</a></dd>
    {% endfor %}
    {% for evenement in lieu.evenements.all %}
      {% if forloop.first %}
        <dt>
          Événement{{ lieu.evenements.all|pluralize }}
          <a href="{% url 'catalogue.views.index_evenements' lieu.slug %}">
            (afficher tous)
          </a>
        </dt>
      {% endif %}
      <dd>
        {% with evenement.ancrage_debut as date %}
          <a href="{% url 'catalogue.views.index_evenements' lieu.slug date.year date.month date.day %}">
            {{ date.calc_moment|capfirst }}
          </a>
        {% endwith %}
      </dd>
    {% empty %}
      {% if not lieu.enfants.all %}
        Aucun événement référencé pour ce lieu.<br />
      {% endif %}
    {% endfor %}
    {% if lieu.historique %}
      <dt>Historique</dt>
      <dd>{{ lieu.historique }}</dd>
    {% endif %}
  </dl>
  <br />
  <a href="{% url 'admin:catalogue_lieu_change' lieu.pk %}">
    [Modifier]
  </a>
{% endblock %}

